<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views
  http://axelor.com/xml/ns/object-views/object-views_5.4.xsd">
  
  <selection name="projectTask-state-selection">
  	<option value="toDo">To Do</option>
  	<option value="inProgress">In Progress</option>
  	<option value="completed">Completed</option>
  </selection>
  
	  <grid  title="All Tasks" name="allTask-grid" model="com.axelor.apps.project.db.ProjectTask">
	  		<field name="name"/>
			<field name="createDate"/>
			<field name="startDate"/>
			<field name="endDate"/>
			<field name="user"/>
			<field name="project"/>
			<field name="priority"/>
			<field name="state"/>
			<field name="progress" widget="Progress"/>
	  </grid>
  
	  <kanban name="project-task-kanban" title="Project Tasks" model="com.axelor.apps.project.db.ProjectTask"
	  columnBy="state" sequenceBy="priority" onNew="project.task.kanban.on.new" limit="10">
	  <field name="name"/>
	  <field name="user"/>
	  <field name="notes" />
	  <field name="progress"/>
	  <field name="startDate"/>
	  <field name="endDate"/>
	  <hilite color="danger" if="progress == 0" />
	  <hilite color="success" if="progress == 100" />
	  <hilite color="info" if="progress &gt;= 50" />
	  <hilite color="warning" if="progress &gt; 0" />
	  <template><![CDATA[
	  <h4>{{name}}</h4>
	  <img ng-if="user" src="{{$image('user', 'image')}}">
	  <div class="card-body">{{notes}}</div>
	  <div class="card-footer">
	    <i class='fa fa-clock-o'></i> <span>{{startDate|date:'yyyy-MM-dd HH:mm:ss'}}</span>
	  </div>
	  ]]></template>
	</kanban>
  	
  	
  	
	  	<tree name="allTask-tree" title="Tree Tasks">
	
	    <!-- define tree columns -->
	    <column name="title" type="string" />
	    <column name="progress" type="integer" />
	
	    <!-- define 1st level node -->
	    <node model="com.axelor.apps.project.db.Project" onClick="projects.task.open.project">
	      <field name="name" as="title" />
	    </node>
	
	    <!-- define 2nd level node -->
	    <node model="com.axelor.apps.project.db.ProjectTask" parent="project" draggable="true" onClick="projects.task.open.task">
	      <field name="name" as="title" />
	      <field name="progress" as="progress" />
	    </node>
	
	  	</tree>
	  	
	  	
	  <form title="All Task" name="allTask-form" model="com.axelor.apps.project.db.ProjectTask" onNew="project.task.kanban.on.new.allTask">
	  		<panel title="Overview">
	  		<field name="name" />
			<field name="createDate"/>
			<field name="startDate" />
			<field name="endDate"/>
			<field name="user"  onSelect="action.project.change"/>
			<field name="project"/>
			<field name="priority"/>
			<field name="state" />
			<field name="parentTask"/>
			<field name="progress" widget="Progress"/>
	  		</panel>
	  		
	  		<panel-tabs>
	  		<panel-related field="workItems" editable="true" onNew="project.task.kanban.on.new.newItem">
	  			<field name="name"/>
	  			<field name="date"/>
	  			<field name="hours"/>
	  		</panel-related>
	  		<panel title="Notes">
	  			<field name="notes" showTitle="false" colSpan="12"/>
	  		</panel>
	  		</panel-tabs>
	  		
	  	</form>
	  	
	  	
  			<action-record name="project.task.kanban.on.new" model="com.axelor.apps.project.db.ProjectTask">
			    <field name="name" expr="#{_value}"/>
			    <field name="user" expr="#{__user__}"/>
			    <field name="createDate" expr="#{__time__}"/>
			    <field name="startDate" expr="#{__time__}"/>
			    <field name="endDate" expr="#{__time__.plusHours(1)}"/>
			    <field name="priority" expr="0" />
 		  </action-record>
 		  
 		  <action-record name="project.task.kanban.on.new.allTask" model="com.axelor.apps.project.db.ProjectTask">
			    <field name="user" expr="#{__user__}"/>
			    <field name="createDate" expr="#{__time__}"/>
			    <field name="priority" expr="0" />
 		  </action-record>
 		  
 		  <action-record name="project.task.kanban.on.new.newItem" model="com.axelor.apps.project.db.ProjectWork">
 		  	<field name="date" expr="#{__time__}"/>
 		  </action-record>
  			
<!--   		<action-attrs name="state.action"> -->
<!--   			<attribute name="hidden" for="endDate" expr="eval: state=='completed'"/> -->
<!--   		</action-attrs> -->
  
  </object-views>